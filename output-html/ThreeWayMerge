<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="robots" content="index,nofollow">

<title>ThreeWayMerge - Revctrl Wiki</title>
<script type="text/javascript" src="/static184/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/static184/modern/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="/static184/modern/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="/static184/modern/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="/static184/modern/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/static184/modern/css/msie.css">
<![endif]-->





<link rel="Start" href="/FrontPage">
<link rel="Alternate" title="Wiki Markup" href="/ThreeWayMerge?action=raw">
<link rel="Alternate" media="print" title="Print View" href="/ThreeWayMerge?action=print">
<link rel="Search" href="/FindPage">
<link rel="Index" href="/TitleIndex">
<link rel="Glossary" href="/WordIndex">
<link rel="Help" href="/HelpOnFormatting">
</head>

<body  lang="en" dir="ltr">

<div id="header">


<form id="searchform" method="get" action="/ThreeWayMerge">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles">
<input id="fullsearch" name="fullsearch" type="submit"
    value="Text" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<ul id="username"><li><a href="/ThreeWayMerge?action=login" id="login" rel="nofollow">Login</a></li></ul>
<div id="locationline">
<div id="interwiki"><span><a href="/FrontPage" rel="nofollow">Revctrl Wiki</a></span></div>

<ul id="pagelocation">
<li><a class="backlink" href="/ThreeWayMerge?action=fullsearch&amp;context=180&amp;value=linkto%3A%22ThreeWayMerge%22" rel="nofollow" title="Click to do a full-text search for this title">ThreeWayMerge</a></li>
</ul>

</div>


<ul id="navibar">
<li class="wikilink"><a href="/FrontPage">FrontPage</a></li><li class="wikilink"><a href="/RecentChanges">RecentChanges</a></li><li class="wikilink"><a href="/FindPage">FindPage</a></li><li class="wikilink"><a href="/HelpContents">HelpContents</a></li><li class="current"><a href="/ThreeWayMerge">ThreeWayMerge</a></li>
</ul>

<div id="pageline"><hr style="display:none;"></div>

<ul class="editbar"><li><span class="disabled">Immutable Page</span></li><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbinfo" href="/ThreeWayMerge?action=info" rel="nofollow">Info</a></li><li><a class="nbattachments" href="/ThreeWayMerge?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="/ThreeWayMerge">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="raw">Raw Text</option>
<option value="print">Print View</option>
<option value="RenderAsDocbook">Render as Docbook</option>
<option value="refresh">Delete Cache</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="SpellCheck">Check Spelling</option>
<option value="LikePages">Like Pages</option>
<option value="LocalSiteMap">Local Site Map</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
<option value="show" disabled class="disabled">Package Pages</option>
<option value="SyncPages">Sync Pages</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="Load">Load</option>
<option value="Save">Save</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><p class="line867">
<h1 id="Summary">Summary</h1>
<span class="anchor" id="line-2"></span><p class="line874">Three-way merge is a staple of revision control systems such as CVS and Bazaar.  It takes three inputs: THIS, BASE, and OTHER.  THIS is the current value in the user's tree.  OTHER is the current value in the tree to be merged.  BASE is a basis for comparison between THIS and OTHER, and is usually an ancestor of them. <span class="anchor" id="line-3"></span><span class="anchor" id="line-4"></span><p class="line874">The operation of three way merge can be paraphrased as "keep my changes, but apply the changes OTHER made to my copy". <span class="anchor" id="line-5"></span><span class="anchor" id="line-6"></span><p class="line874">Consider the values in each version in a scalar merge context. <span class="anchor" id="line-7"></span><ul><li style="list-style-type:none"><div><table><tbody><tr>  <td><p class="line862">Case</td>
  <td><p class="line862">THIS</td>
  <td><p class="line862">BASE</td>
  <td><p class="line862">OTHER</td>
  <td><p class="line862">RESULT                    </td>
</tr>
<tr>  <td><span class="anchor" id="line-8"></span><p class="line862">1.  </td>
  <td><p class="line862">A   </td>
  <td><p class="line862">A   </td>
  <td><p class="line862">A    </td>
  <td><p class="line862">A (Boring case)           </td>
</tr>
<tr>  <td><span class="anchor" id="line-9"></span><p class="line862">2.  </td>
  <td><p class="line862">B   </td>
  <td><p class="line862">A   </td>
  <td><p class="line862">A    </td>
  <td><p class="line862">B (Take change from THIS) </td>
</tr>
<tr>  <td><span class="anchor" id="line-10"></span><p class="line862">3.  </td>
  <td><p class="line862">A   </td>
  <td><p class="line862">A   </td>
  <td><p class="line862">B    </td>
  <td><p class="line862">B (Take change from OTHER)</td>
</tr>
<tr>  <td><span class="anchor" id="line-11"></span><p class="line862">4.  </td>
  <td><p class="line862">A   </td>
  <td><p class="line862">B   </td>
  <td><p class="line862">A    </td>
  <td><p class="line862">A (<a href="/AccidentalCleanMerge">AccidentalCleanMerge</a>)  </td>
</tr>
<tr>  <td><span class="anchor" id="line-12"></span><p class="line862">5.  </td>
  <td><p class="line862">A   </td>
  <td><p class="line862">B   </td>
  <td><p class="line862">C    </td>
  <td><p class="line862"> <strong>Conflict</strong>           </td>
</tr>
</tbody></table></div><span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span></li></ul><p class="line874">As long as any two versions have the same value, the algorithm produces a result.  A conflict happens when all versions are have different values, because it is not clear whether OTHER or THIS (or some combination) should be taken. It is not universally accepted that case 4 should merge cleanly, so this case is sometimes an exception. <span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span><p class="line862">Conceptually, in a textual merge context [:Resolution:resolution] is performed between BASE and the other 2 versions in turn (at merge time, ignoring changes in between). Discrete sections of the versions can then be compared according the above chart. <span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><p class="line874">Gnu diff3 is a common implementation of three-way text merging. <span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><p class="line862">The selection of an appropriate base is important in three-way merges, because three-way works best when the base is similar to THIS and OTHER.  The less similar it is, the more chance that it will have a different value from either THIS or BASE, causing unnecessary conflicts. In addition, less similarity can result in [:Resolution:resolution] errors, which can cause confusing conflicts and bad clean merges. <span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><p class="line862">See <a href="/ThreeWayTextMergeImplementation">ThreeWayTextMergeImplementation</a> for implementation details. <span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span><p class="line867">
<h1 id="Diff_.26_Patch">Diff &amp; Patch</h1>
<span class="anchor" id="line-25"></span><p class="line862">Diff and patch can be used to perform something like a three-way merge.  One simply performs a diff from BASE to OTHER, and then uses patch to apply it to THIS.  This approach is more limited than diff3.  In case 4, instead of reporting a clean merge, it necessarily produces a conflict. This approach is also prone to even worse [:Resolution:resolution] errors than more intelligent implementations. <span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span><p class="line867">
<h1 id="Strengths">Strengths</h1>
<span class="anchor" id="line-28"></span><ul><li>Requires just three inputs <span class="anchor" id="line-29"></span></li><li>Reasonably simple to understand and implement (ignoring BASE selection) <span class="anchor" id="line-30"></span></li><li>Implementations widely available <span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span></li></ul><p class="line867">
<h1 id="Weaknesses">Weaknesses</h1>
<span class="anchor" id="line-33"></span><ul><li><p class="line862">Prone to [:Resolution:resolution] errors due to not being fully history-aware <span class="anchor" id="line-34"></span></li><li><p class="line862">A <a href="/CrissCrossMerge">CrissCrossMerge</a> produces a strange later three-way-merge <span class="anchor" id="line-35"></span></li><li>Some scenarios can cause text to be lost that should not be <span class="anchor" id="line-36"></span></li><li>Difficult to choose a decent BASE in arbitrary history graphs <span class="anchor" id="line-37"></span></li><li><p class="line862">Cannot support [:Convergence:convergence] <span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span></li></ul><p class="line867">
<h1 id="Used_by">Used by</h1>
<span class="anchor" id="line-40"></span><ul><li style="list-style-type:none">["CVS"], ["Arch"], ["Bazaar"], ["Bazaar-NG"], ["Monotone"], many others <span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span></li></ul><p class="line867">
<h1 id="Related">Related</h1>
<span class="anchor" id="line-43"></span><ul><li style="list-style-type:none">Patch/diff merge <span class="anchor" id="line-44"></span></li></ul><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span><p class="line867"><a href="/CategoryMergeAlgorithm">CategoryMergeAlgorithm</a> <span class="anchor" id="line-47"></span><span class="anchor" id="bottom"></span></div><p id="pageinfo" class="info" lang="en" dir="ltr">Revctrl Wiki: ThreeWayMerge  (last edited 2007-08-03 00:46:03 by <span title="MiguelProvencio @ 71-222-221-102.albq.qwest.net[71.222.221.102]"><a class="nonexistent" href="/MiguelProvencio" title="MiguelProvencio @ 71-222-221-102.albq.qwest.net[71.222.221.102]">MiguelProvencio</a></span>)</p>

<div id="pagebottom"></div>
</div>


<div id="footer">
<ul class="editbar"><li><span class="disabled">Immutable Page</span></li><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbinfo" href="/ThreeWayMerge?action=info" rel="nofollow">Info</a></li><li><a class="nbattachments" href="/ThreeWayMerge?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="/ThreeWayMerge">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="raw">Raw Text</option>
<option value="print">Print View</option>
<option value="RenderAsDocbook">Render as Docbook</option>
<option value="refresh">Delete Cache</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="SpellCheck">Check Spelling</option>
<option value="LikePages">Like Pages</option>
<option value="LocalSiteMap">Local Site Map</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
<option value="show" disabled class="disabled">Package Pages</option>
<option value="SyncPages">Sync Pages</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="Load">Load</option>
<option value="Save">Save</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

<ul id="credits">
<li><a href="http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
</body>
</html>

